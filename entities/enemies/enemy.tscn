[gd_scene load_steps=20 format=3 uid="uid://d8g64g8viihh"]

[ext_resource type="Script" uid="uid://ba6qmt80akqib" path="res://entities/enemies/enemy.gd" id="1_ksmh7"]
[ext_resource type="PackedScene" uid="uid://b72gnkqh5atrs" path="res://UI/HealthBar3D/health_bar_3d.tscn" id="2_twyc1"]
[ext_resource type="PackedScene" uid="uid://jwhg4beayert" path="res://entities/health_component/HealthComponent.tscn" id="2_wqcwe"]
[ext_resource type="Script" uid="uid://nqcrxsuj1cdf" path="res://UI/HealthBar3D/enemy_health_bar.gd" id="3_2ggct"]
[ext_resource type="PackedScene" uid="uid://duk5b06ohkpsc" path="res://entities/enemies/monstr.tscn" id="3_5lf1o"]
[ext_resource type="PackedScene" uid="uid://bh7ppnkyaubf7" path="res://vfx/hit_flash/HitFlash.tscn" id="4_msovg"]
[ext_resource type="Shader" uid="uid://cjpfd2tbkieq0" path="res://entities/player/assets/toonShader.gdshader" id="5_w4yt1"]
[ext_resource type="Script" uid="uid://bms48mt88e42c" path="res://entities/enemies/components/vision_component.gd" id="7_56i32"]
[ext_resource type="Script" uid="uid://c55cu0n3gbdfm" path="res://entities/enemies/components/enemy_attack_component.gd" id="8_sb13e"]
[ext_resource type="Script" uid="uid://cbx8244k71rsk" path="res://common/fsm/state_machine.gd" id="9_3udgd"]
[ext_resource type="Script" uid="uid://cxbbb82wp8q2v" path="res://entities/enemies/states/enemy_idle.gd" id="10_xmuku"]
[ext_resource type="Script" uid="uid://cvvgodl7fxgrn" path="res://entities/enemies/states/enemy_patrol.gd" id="11_2ggct"]
[ext_resource type="Script" uid="uid://cbsjg06awuo6g" path="res://entities/enemies/states/enemy_chase.gd" id="12_wy1il"]
[ext_resource type="Script" uid="uid://dirsi2ohsa4hb" path="res://entities/enemies/states/enemy_attack.gd" id="13_53k0f"]
[ext_resource type="Script" uid="uid://c6ccg8dnavfcp" path="res://entities/enemies/states/enemy_frustrated.gd" id="14_u01qb"]
[ext_resource type="Script" uid="uid://bn3bsn15qof6y" path="res://entities/enemies/states/enemy_dead.gd" id="15_4teby"]

[sub_resource type="ShaderMaterial" id="ShaderMaterial_ipr6v"]
render_priority = 0
shader = ExtResource("5_w4yt1")
shader_parameter/use_hit_flash = false
shader_parameter/hit_flash_strength = 1.0
shader_parameter/hit_flash_color = Color(1, 0.1, 0.1, 1)
shader_parameter/dissolve_amount = 0.0
shader_parameter/albedo = Color(1, 1, 1, 1)
shader_parameter/clamp_diffuse_to_max = false
shader_parameter/cuts = 3
shader_parameter/wrap = 0.0
shader_parameter/steepness = 1.0
shader_parameter/use_attenuation = true
shader_parameter/use_specular = true
shader_parameter/specular_strength = 1.0
shader_parameter/specular_shininess = 16.0
shader_parameter/use_rim = true
shader_parameter/rim_width = 8.0
shader_parameter/rim_color = Color(1, 1, 1, 1)
shader_parameter/use_ramp = false
shader_parameter/use_borders = false
shader_parameter/border_width = 0.01
shader_parameter/use_gradient = false
shader_parameter/gradient_blend_mode = 0
shader_parameter/gradient_strength = 1.0
shader_parameter/mesh_min_y = 0.0
shader_parameter/mesh_max_y = 1.0
shader_parameter/gradient_uv_set = 0

[sub_resource type="BoxShape3D" id="BoxShape3D_msovg"]
size = Vector3(2.765625, 1.7850952, 2.4552612)

[sub_resource type="CapsuleShape3D" id="CapsuleShape3D_lw7nh"]

[node name="Enemy" type="CharacterBody3D" node_paths=PackedStringArray("punch_hand_r", "punch_hand_l", "punch_area") groups=["enemies"]]
collision_layer = 4
collision_mask = 15
script = ExtResource("1_ksmh7")
punch_hand_r = NodePath("Monstr/root/Skeleton3D/hand_r/punch_hand_r")
punch_hand_l = NodePath("Monstr/root/Skeleton3D/hand_l/punch_hand_l")
punch_area = NodePath("Monstr/PunchArea")
run_speed = 4.5
retreat_speed = 1.5
knockback_strength = 1.0
knockback_duration = 0.1

[node name="HealthBar3D" parent="." instance=ExtResource("2_twyc1")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 2.175171, 0)
script = ExtResource("3_2ggct")

[node name="HealthComponent" parent="." instance=ExtResource("2_wqcwe")]
max_health = 5.0

[node name="EnemyAttackComponent" type="Node" parent="."]
script = ExtResource("8_sb13e")
tactical_retreat_distance = 3.0
retreat_interrupt_range = 0.8

[node name="HitFlash" parent="." instance=ExtResource("4_msovg")]
mesh_path = NodePath("../Monstr/root/Skeleton3D/Monstr")
flash_shader = SubResource("ShaderMaterial_ipr6v")
flash_color = Color(1, 1, 1, 1)
flash_time = 0.2

[node name="NavigationAgent3D" type="NavigationAgent3D" parent="."]
avoidance_enabled = true
radius = 0.6
max_speed = 20.0

[node name="Monstr" parent="." instance=ExtResource("3_5lf1o")]
transform = Transform3D(-1, 0, -8.742278e-08, 0, 1, 0, 8.742278e-08, 0, -1, 0, 0, 0)

[node name="Skeleton3D" parent="Monstr/root" index="0"]
bones/1/position = Vector3(-8.497717e-11, 0.43805516, 0.003183168)
bones/1/rotation = Quaternion(-0.041497115, -2.1073022e-06, 8.853058e-08, 0.9991387)
bones/2/position = Vector3(-0.02194136, 0.27983177, -0.00016443939)
bones/2/rotation = Quaternion(-0.064863436, -0.026074147, 0.05228667, 0.9961822)
bones/3/rotation = Quaternion(0.23842315, 3.1317022e-06, 4.6789037e-06, 0.9711614)
bones/4/position = Vector3(6.868728e-09, 0.06338361, -8.4406096e-08)
bones/4/rotation = Quaternion(-0.1424176, 0.001444606, -0.0029096904, 0.98980135)
bones/4/scale = Vector3(1, 0.99999994, 1.0000001)
bones/5/position = Vector3(-0.12893781, 0.47539034, -0.033183295)
bones/5/rotation = Quaternion(-0.53975743, 0.43011627, 0.5670756, 0.44954112)
bones/6/rotation = Quaternion(-0.20399082, 0.33905745, -0.12004255, 0.9105041)
bones/6/scale = Vector3(1, 0.9999985, 0.9999998)
bones/7/rotation = Quaternion(-1.7838363e-07, -0.387888, -1.1751943e-07, 0.9217065)
bones/7/scale = Vector3(0.9999999, 1.000001, 1.0000001)
bones/8/rotation = Quaternion(-4.874318e-08, 9.057724e-08, 0.53707886, 0.843532)
bones/8/scale = Vector3(1.0000002, 1.0000005, 0.9999999)
bones/9/rotation = Quaternion(3.0683335e-08, 0.110987455, 1.5051645e-08, 0.99382186)
bones/10/rotation = Quaternion(-0.23446798, 0.018616706, 0.25618333, 0.93757576)
bones/10/scale = Vector3(0.9999991, 0.99999964, 0.9999993)
bones/11/position = Vector3(0.12892565, 0.47540313, -0.033090804)
bones/11/rotation = Quaternion(0.5395321, 0.43042633, 0.5672497, -0.449295)
bones/12/rotation = Quaternion(0.14927965, -0.3873525, -0.0031288692, 0.90976036)
bones/12/scale = Vector3(1.0000001, 0.9999918, 1.0000002)
bones/13/rotation = Quaternion(3.348613e-07, 0.53117573, -1.2689661e-07, 0.8472617)
bones/13/scale = Vector3(0.9999998, 0.99999976, 1.0000001)
bones/14/rotation = Quaternion(2.3245865e-07, 7.3838398e-09, -0.67987055, 0.73333216)
bones/14/scale = Vector3(1.0000036, 0.9999958, 1)
bones/15/rotation = Quaternion(5.3084914e-08, -0.39828345, -1.1978103e-07, 0.9172625)
bones/16/rotation = Quaternion(0.017870996, -0.40080595, 0.13959824, 0.90528876)
bones/16/scale = Vector3(0.9999991, 1.000007, 0.99999976)
bones/17/rotation = Quaternion(0.69522274, 0.13756962, 0.69205546, 0.13711067)
bones/17/scale = Vector3(0.9999999, 0.99999976, 0.99999994)
bones/18/rotation = Quaternion(2.147336e-09, -6.4785427e-06, 1.0179533e-06, 1)
bones/19/rotation = Quaternion(-1.6617575e-08, 1.6597063e-08, 0.5215202, 0.85323906)
bones/19/scale = Vector3(0.9999998, 0.99999994, 0.99999976)
bones/20/rotation = Quaternion(0.4237372, 0.5678044, -0.42336795, 0.5646278)
bones/20/scale = Vector3(1.0000001, 1.0000001, 0.99999994)
bones/21/rotation = Quaternion(-5.4449083e-07, 0.9152514, 0.40288326, -4.6125118e-07)
bones/22/rotation = Quaternion(4.8254133e-08, -1.1481354e-05, -3.0045047e-08, 1)
bones/23/rotation = Quaternion(0.69521976, -0.13756904, -0.6920584, 0.13711119)
bones/23/scale = Vector3(0.9999999, 1.0000001, 0.99999994)
bones/24/rotation = Quaternion(1.6850155e-09, 6.548827e-06, -7.047125e-07, 1)
bones/25/rotation = Quaternion(-3.9865203e-08, -5.7917195e-08, -0.5215199, 0.8532392)
bones/25/scale = Vector3(1, 0.99999976, 0.9999998)
bones/26/rotation = Quaternion(0.42373714, -0.5678043, 0.42336786, 0.564628)
bones/26/scale = Vector3(1.0000002, 1.0000002, 1)
bones/27/rotation = Quaternion(5.2688335e-07, 0.91525143, 0.4028831, 4.2125163e-07)
bones/28/rotation = Quaternion(4.8414023e-08, 1.1660185e-05, 5.1855176e-07, 1)

[node name="hand_r" parent="Monstr/root/Skeleton3D" index="1"]
transform = Transform3D(-0.63941246, -0.20781124, -0.74024606, -0.75009555, 0.38002014, 0.54123795, 0.16883332, 0.90133154, -0.39886785, -1.0233968, 0.77787334, -0.013312817)

[node name="CollisionShape3D" parent="Monstr/root/Skeleton3D/hand_r/punch_hand_r" index="0"]
transform = Transform3D(2, 1.1920928e-07, -3.9736424e-08, -1.1920928e-07, 2, 4.4703487e-08, 3.9736427e-08, -4.4703484e-08, 2, 0.014108133, 0.12905324, -0.011775196)

[node name="hand_l" parent="Monstr/root/Skeleton3D" index="2"]
transform = Transform3D(-0.7359143, 0.26928648, 0.62121314, 0.5512997, 0.77095747, 0.31889662, -0.3930561, 0.57716054, -0.7158169, 0.8421833, 1.3928812, -0.013078794)

[node name="AnimationPlayer" parent="Monstr" index="1"]
autoplay = "Monstr_idle"
playback_default_blend_time = 0.2
blend_times = [&"Monstr_idle", &"Monstr_angry", 0.2, &"Monstr_idle", &"Monstr_attack_1", 0.2, &"Monstr_idle", &"Monstr_attack_idle", 0.2, &"Monstr_idle", &"Monstr_idle", 0.2, &"Monstr_idle", &"Monstr_knockdown", 0.2, &"Monstr_idle", &"Monstr_walk", 0.2]

[node name="PunchArea" type="Area3D" parent="Monstr"]

[node name="CollisionShape3D" type="CollisionShape3D" parent="Monstr/PunchArea"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.8913391, 1.4406242)
shape = SubResource("BoxShape3D_msovg")

[node name="CollisionShape3D" type="CollisionShape3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0)
shape = SubResource("CapsuleShape3D_lw7nh")

[node name="VisionComponent" type="Node3D" parent="."]
script = ExtResource("7_56i32")

[node name="AttackTimer" type="Timer" parent="."]

[node name="StateMachine" type="Node" parent="." node_paths=PackedStringArray("initial_state")]
script = ExtResource("9_3udgd")
initial_state = NodePath("Idle")

[node name="Idle" type="Node" parent="StateMachine"]
script = ExtResource("10_xmuku")

[node name="Patrol" type="Node" parent="StateMachine"]
script = ExtResource("11_2ggct")

[node name="Chase" type="Node" parent="StateMachine"]
script = ExtResource("12_wy1il")

[node name="Attack" type="Node" parent="StateMachine"]
script = ExtResource("13_53k0f")

[node name="Frustrated" type="Node" parent="StateMachine"]
script = ExtResource("14_u01qb")

[node name="Dead" type="Node" parent="StateMachine"]
script = ExtResource("15_4teby")

[editable path="Monstr"]
