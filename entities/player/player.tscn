[gd_scene load_steps=28 format=3 uid="uid://c364awakh0qqj"]

[ext_resource type="Script" uid="uid://pvqa8xdknxqq" path="res://entities/player/player.gd" id="1_1hmtu"]
[ext_resource type="PackedScene" uid="uid://bh7ppnkyaubf7" path="res://vfx/hit_flash/HitFlash.tscn" id="2_8fjmc"]
[ext_resource type="PackedScene" uid="uid://k5os7k8wlcvf" path="res://entities/player/assets/character.tscn" id="2_635qg"]
[ext_resource type="PackedScene" uid="uid://jwhg4beayert" path="res://entities/health_component/HealthComponent.tscn" id="2_fkugw"]
[ext_resource type="Material" uid="uid://c3gmswlr7otco" path="res://entities/player/assets/character.tres" id="3_sglur"]

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_fkugw"]
animation = &"Boy_jump_mid"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_8fjmc"]
animation = &"Boy_jump_start"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_26q78"]
animation = &"Boy_run"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_bectd"]
animation = &"Boy_walk"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_wvtmh"]
animation = &"Boy_stopping"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_mtric"]
animation = &"Boy_roll_loop"
advance_on_start = true

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_7thud"]
animation = &"Boy_attack_air_naked_end"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_a1qjk"]
animation = &"Boy_attack_air_naked_mid"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_j3ovn"]
animation = &"Boy_attack_air_naked_start"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_afbqv"]
animation = &"Boy_attack_naked_1"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_gx6sm"]
animation = &"Boy_attack_naked_2"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_yqrof"]
animation = &"Boy_attack_naked_3"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_3wlsy"]
animation = &"Boy_idle"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_b2kln"]
animation = &"Boy_jump_end"

[sub_resource type="AnimationNodeAnimation" id="AnimationNodeAnimation_we0b7"]
animation = &"Boy_air_dash"

[sub_resource type="Curve" id="Curve_fkugw"]
_data = [Vector2(0, 0), 0.0, 0.0, 0, 0, Vector2(1, 1), 0.0, 0.0, 0, 0]
point_count = 2

[sub_resource type="Curve" id="Curve_8fjmc"]
_data = [Vector2(0, 1), 0.0, 0.0, 0, 0, Vector2(1, 0), 0.0, 0.0, 0, 0]
point_count = 2

[sub_resource type="AnimationNodeOneShot" id="AnimationNodeOneShot_eyb6c"]
sync = true
fadein_time = 0.1
fadein_curve = SubResource("Curve_fkugw")
fadeout_time = 0.1
fadeout_curve = SubResource("Curve_8fjmc")
break_loop_at_end = true

[sub_resource type="AnimationNodeBlend3" id="AnimationNodeBlend3_fkugw"]

[sub_resource type="AnimationNodeBlendTree" id="AnimationNodeBlendTree_fkugw"]
nodes/output/position = Vector2(1072, -96)
nodes/Animation/node = SubResource("AnimationNodeAnimation_we0b7")
nodes/Animation/position = Vector2(-128, 112)
"nodes/Animation 2/node" = SubResource("AnimationNodeAnimation_7thud")
"nodes/Animation 2/position" = Vector2(-160, 320)
"nodes/Animation 3/node" = SubResource("AnimationNodeAnimation_a1qjk")
"nodes/Animation 3/position" = Vector2(-400, 320)
"nodes/Animation 4/node" = SubResource("AnimationNodeAnimation_j3ovn")
"nodes/Animation 4/position" = Vector2(-656, 320)
"nodes/Animation 5/node" = SubResource("AnimationNodeAnimation_afbqv")
"nodes/Animation 5/position" = Vector2(-624, -80)
"nodes/Animation 6/node" = SubResource("AnimationNodeAnimation_gx6sm")
"nodes/Animation 6/position" = Vector2(-416, -80)
"nodes/Animation 7/node" = SubResource("AnimationNodeAnimation_yqrof")
"nodes/Animation 7/position" = Vector2(-208, -80)
"nodes/Animation 8/node" = SubResource("AnimationNodeAnimation_3wlsy")
"nodes/Animation 8/position" = Vector2(32, -528)
"nodes/Animation 9/node" = SubResource("AnimationNodeAnimation_b2kln")
"nodes/Animation 9/position" = Vector2(544, -736)
"nodes/Animation 10/node" = SubResource("AnimationNodeAnimation_fkugw")
"nodes/Animation 10/position" = Vector2(384, -736)
"nodes/Animation 11/node" = SubResource("AnimationNodeAnimation_8fjmc")
"nodes/Animation 11/position" = Vector2(208, -736)
"nodes/Animation 16/node" = SubResource("AnimationNodeAnimation_mtric")
"nodes/Animation 16/position" = Vector2(320, -80)
"nodes/Animation 13/node" = SubResource("AnimationNodeAnimation_26q78")
"nodes/Animation 13/position" = Vector2(32, -208)
"nodes/Animation 14/node" = SubResource("AnimationNodeAnimation_bectd")
"nodes/Animation 14/position" = Vector2(32, -368)
"nodes/Animation 15/node" = SubResource("AnimationNodeAnimation_wvtmh")
"nodes/Animation 15/position" = Vector2(144, 96)
nodes/locomotion/node = SubResource("AnimationNodeBlend3_fkugw")
nodes/locomotion/position = Vector2(256, -432)
nodes/RollLoop/node = SubResource("AnimationNodeOneShot_eyb6c")
nodes/RollLoop/position = Vector2(688, -256)
node_connections = [&"output", 0, &"RollLoop", &"locomotion", 0, &"Animation 8", &"locomotion", 1, &"Animation 14", &"locomotion", 2, &"Animation 13", &"RollLoop", 0, &"locomotion", &"RollLoop", 1, &"Animation 16"]

[sub_resource type="CapsuleShape3D" id="CapsuleShape3D_yel1f"]
radius = 0.441262

[sub_resource type="BoxShape3D" id="BoxShape3D_abrql"]
size = Vector3(1.7636719, 1.746582, 2.362335)

[node name="Player" type="CharacterBody3D" node_paths=PackedStringArray("punch_hand_r", "punch_hand_l") groups=["player"]]
collision_mask = 28
floor_constant_speed = true
platform_on_leave = 1
script = ExtResource("1_1hmtu")
jump_height = 1.45
jump_time_to_peak = 0.3
air_control = 0.3
second_jump_multiplier = 1.4
slam_radius = 2.5
slam_descent_speed = 30.0
slam_cooldown = 3.0
slam_windup_delay = 0.2
stop_speed = 10.0
acceleration = 0.2
rot_speed = 10.0
push_force = 0.2
roll_push_multiplier = 10.0
roll_jump_cancel_threshold = 0.3
auto_run_latch_time = 0.3
roll_cooldown = 2.0
roll_recharge_time = 4.0
roll_chain_delay = 0.2
attack_roll_cancel_threshold = 0.0
air_dash_speed = 10.0
air_dash_distance = 2.0
air_dash_cooldown = 2.0
primary_attack_speed = 1.0
attack_movement_influense = 0.01
attack_cooldown = 0.0
combo_window_time = 0.5
attack_knockback_strength = 2.5
attack_knockback_height = 1.0
running_attack_impulse = 30.0
walking_attack_impulse = 10.0
idle_attack_impulse = 3.0
attack_rotation_influence = 0.2
punch_hand_r = NodePath("character/root/Skeleton3D/hand_r/punch_hand_r")
punch_hand_l = NodePath("character/root/Skeleton3D/hand_l/punch_hand_l")

[node name="HitFlash" parent="." instance=ExtResource("2_8fjmc")]
mesh_path = NodePath("../character/root/Skeleton3D/Character_mesh")
flash_color = Color(1, 0, 0, 1)
flash_time = 0.15

[node name="HealthComponent" parent="." instance=ExtResource("2_fkugw")]

[node name="character" parent="." instance=ExtResource("2_635qg")]

[node name="Skeleton3D" parent="character/root" index="0"]
bones/0/position = Vector3(-4.2351647e-22, 0.19384648, -4.4667753e-22)
bones/0/rotation = Quaternion(-0.057899334, 8.727611e-08, -5.0617204e-09, 0.9983224)
bones/1/position = Vector3(-0.017376453, 0.43615302, 6.746675e-05)
bones/1/rotation = Quaternion(0.05723189, 0.008776555, -0.06859007, 0.99596334)
bones/1/scale = Vector3(1, 0.9999997, 0.9999998)
bones/2/position = Vector3(-0.01816201, 0.27608532, 0.020016652)
bones/2/rotation = Quaternion(-0.091479324, -0.026622249, -0.0017826017, 0.99544954)
bones/2/scale = Vector3(0.9999998, 1, 0.99999994)
bones/3/position = Vector3(-0.018088013, 0.28433278, 0.020025441)
bones/3/rotation = Quaternion(-0.080815025, -0.02660497, -0.002067872, 0.99637187)
bones/3/scale = Vector3(0.99999994, 1.0000002, 1.0000002)
bones/4/position = Vector3(-3.7255874e-09, 0.20869692, -1.0789793e-08)
bones/4/rotation = Quaternion(0.12025622, 3.2442194e-06, 2.363647e-06, 0.9927429)
bones/5/position = Vector3(-1.8627198e-08, 0.12101834, 2.1920139e-08)
bones/5/rotation = Quaternion(-0.004767096, -0.02205782, -0.020208765, 0.9995411)
bones/6/position = Vector3(0.095663644, 0.07201035, -0.0322163)
bones/6/rotation = Quaternion(-0.5621544, -0.4104841, -0.4223358, 0.5806184)
bones/7/rotation = Quaternion(0.017180707, 0.010429874, 0.32770327, 0.9445669)
bones/7/scale = Vector3(1, 1, 1.0000002)
bones/8/rotation = Quaternion(1.13425216e-07, 0.3116101, -2.3921103e-07, 0.9502101)
bones/8/scale = Vector3(0.9999997, 0.99999946, 0.99999976)
bones/9/rotation = Quaternion(-3.9339548e-07, 3.9296174e-07, -0.58329844, 0.812258)
bones/9/scale = Vector3(1.0000001, 1.0000004, 1)
bones/10/rotation = Quaternion(-2.0271875e-08, 0.15153566, -3.962446e-08, 0.9884518)
bones/10/scale = Vector3(0.9999998, 1.0000001, 0.99999976)
bones/11/rotation = Quaternion(0.06668013, 0.15230054, 0.056376252, 0.9844695)
bones/11/scale = Vector3(0.9999987, 0.99999887, 0.9999991)
bones/12/position = Vector3(0.05221226, 0.027676344, -0.009928363)
bones/12/rotation = Quaternion(0.15248078, 0.81465745, -0.39233047, 0.39894816)
bones/12/scale = Vector3(0.99999994, 0.9999998, 1.0000004)
bones/13/rotation = Quaternion(-0.079445206, -0.06545246, -0.035929244, 0.994039)
bones/14/rotation = Quaternion(-0.13378468, 0.07860493, -0.08146652, 0.9845233)
bones/16/rotation = Quaternion(-0.0575589, 0.0035025536, -0.019824717, 0.99813914)
bones/16/scale = Vector3(0.99999976, 0.9999998, 0.99999994)
bones/17/rotation = Quaternion(-0.18569705, -0.045631498, 0.03433677, 0.9809462)
bones/18/rotation = Quaternion(-0.14129066, -0.0074739214, 0.004723705, 0.9899287)
bones/19/position = Vector3(-0.09566374, 0.07551345, -0.0029079774)
bones/19/rotation = Quaternion(-0.4843319, 0.5036325, 0.49191985, 0.5194149)
bones/20/rotation = Quaternion(-0.5006469, 0.4892921, 0.4118688, 0.58336097)
bones/20/scale = Vector3(1.0000001, 1.8973846, 0.9999996)
bones/21/rotation = Quaternion(-1.4546949e-07, -0.36780098, 6.65519e-08, 0.9299046)
bones/21/scale = Vector3(0.9999997, 0.99999917, 0.9999999)
bones/22/rotation = Quaternion(-0.016483068, 0.0006629309, 0.35570878, 0.93445134)
bones/22/scale = Vector3(0.82376033, 1.2365273, 0.99959844)
bones/23/rotation = Quaternion(-1.04041185e-07, 0.82694757, 3.6893244e-08, 0.562279)
bones/23/scale = Vector3(0.99999994, 1.0000002, 1)
bones/24/rotation = Quaternion(-0.14991565, 0.8123467, -0.020495994, 0.5632035)
bones/24/scale = Vector3(1.7389388, 1.161606, 1.7422163)
bones/25/position = Vector3(-0.052212108, 0.027676383, -0.009928402)
bones/25/rotation = Quaternion(0.11851278, 0.7621951, -0.49739793, -0.3969996)
bones/25/scale = Vector3(1, 1, 0.9999999)
bones/26/rotation = Quaternion(-0.28739518, 0.12765299, 0.2138929, 0.92485607)
bones/27/rotation = Quaternion(-0.30249047, 0.043534182, 0.26889974, 0.9133988)
bones/29/rotation = Quaternion(-0.40959176, 0.016221376, 0.06350457, 0.90991133)
bones/29/scale = Vector3(0.9999998, 0.9999998, 0.99999994)
bones/30/rotation = Quaternion(-0.52538115, 0.044881098, 0.0029574402, 0.8496774)
bones/31/rotation = Quaternion(-0.48752937, -0.010247099, 0.0072946544, 0.873016)
bones/32/position = Vector3(0.13895878, 0.0420824, -0.011197317)
bones/32/rotation = Quaternion(0.68622726, 0.23655684, 0.68463165, 0.06642699)
bones/32/scale = Vector3(1.0000014, 0.9810853, 0.99999976)
bones/33/rotation = Quaternion(3.4974104e-09, -0.030670352, -6.932396e-08, 0.9995296)
bones/33/scale = Vector3(0.9999999, 1.0000001, 0.99999994)
bones/34/rotation = Quaternion(-7.7587515e-08, -6.2873355e-08, 0.37486342, 0.92708004)
bones/34/scale = Vector3(1.0093595, 0.9887217, 0.99999994)
bones/35/rotation = Quaternion(-0.31763372, -0.6596433, -0.2796124, 0.6211251)
bones/35/scale = Vector3(1.0001119, 1.008925, 1.0126075)
bones/36/rotation = Quaternion(2.5669016e-05, 0.95456135, -0.29801458, -9.569295e-06)
bones/36/scale = Vector3(1, 0.9999999, 0.9999999)
bones/37/rotation = Quaternion(-2.5653986e-08, -0.0496389, 9.139401e-08, 0.99876726)
bones/37/scale = Vector3(1.0000001, 1.0000002, 1)
bones/38/position = Vector3(-0.13895895, 0.042082347, -0.011195436)
bones/38/rotation = Quaternion(0.72478956, -0.06809136, -0.67295825, 0.13103798)
bones/38/scale = Vector3(0.99999994, 0.9905042, 0.9999999)
bones/39/rotation = Quaternion(2.2946017e-07, -0.006290788, -3.4896365e-07, 0.9999802)
bones/39/scale = Vector3(1, 1.0000001, 1.0000001)
bones/40/rotation = Quaternion(3.7822065e-08, 7.7077985e-08, -0.18702832, 0.9823546)
bones/40/scale = Vector3(1.0012996, 0.9976808, 1.0000001)
bones/41/rotation = Quaternion(-0.09221344, 0.7226772, 0.093188494, 0.6786386)
bones/41/scale = Vector3(1.0000007, 1.0099258, 1.0007222)
bones/42/rotation = Quaternion(2.4119606e-06, 0.8848164, -0.46593997, -1.8094947e-06)
bones/42/scale = Vector3(0.99999994, 0.9999997, 0.99999976)
bones/43/rotation = Quaternion(4.128894e-09, 0.05929776, -6.072747e-08, 0.99824035)
bones/43/scale = Vector3(0.99999994, 1, 1)

[node name="Character_mesh" parent="character/root/Skeleton3D" index="0"]
material_override = ExtResource("3_sglur")
material_overlay = ExtResource("3_sglur")

[node name="hand_r" parent="character/root/Skeleton3D" index="1"]
transform = Transform3D(1.8423684, 0.032034993, -0.01638037, -0.51990736, 1.2988698, -0.50442433, -0.9818435, 1.510828, 2.2355356, -0.3994851, 1.6182972, 0.6244458)

[node name="hand_l" parent="character/root/Skeleton3D" index="2"]
transform = Transform3D(-0.21339384, 0.9736656, -0.08022695, 0.005490452, 0.08331238, 0.9965076, 0.9769494, 0.21220833, -0.023124501, 0.6490216, 1.116913, -0.23472491)

[node name="AnimationTree" type="AnimationTree" parent="character"]
active = false
tree_root = SubResource("AnimationNodeBlendTree_fkugw")
anim_player = NodePath("../AnimationPlayer")
parameters/locomotion/blend_amount = -0.61
parameters/RollLoop/active = false
parameters/RollLoop/internal_active = false
parameters/RollLoop/request = 0

[node name="CollisionShape3D" type="CollisionShape3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0)
shape = SubResource("CapsuleShape3D_yel1f")

[node name="FirstAttackTimer" type="Timer" parent="."]
one_shot = true

[node name="SprintTimer" type="Timer" parent="."]
wait_time = 0.6
one_shot = true

[node name="FirstAttackArea" type="Area3D" parent="."]
collision_mask = 4

[node name="CollisionShape3D" type="CollisionShape3D" parent="FirstAttackArea"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.9123535, 1.2675935)
shape = SubResource("BoxShape3D_abrql")

[connection signal="body_entered" from="character/root/Skeleton3D/hand_r/punch_hand_r" to="." method="_on_punch_hand_r_body_entered"]
[connection signal="body_entered" from="character/root/Skeleton3D/hand_l/punch_hand_l" to="." method="_on_punch_hand_l_body_entered"]
[connection signal="timeout" from="FirstAttackTimer" to="." method="_on_first_attack_timer_timeout"]
[connection signal="timeout" from="SprintTimer" to="." method="_on_sprint_timer_timeout"]

[editable path="character"]
